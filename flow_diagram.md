# Charles Log Parser Project Flow Diagram

```mermaid
graph TD
    %% Main User Interactions
    User([User]) -->|Provides .chlsj file| ClientPy
    User -->|Runs| DashboardTool
    User -->|Views| HTMLDashboard
    User -->|Runs| StreamlitDashboard
    
    %% Main Components
    subgraph "Charles Log Parser Core"
        ClientPy[client.py] -->|Invokes| ServerPy
        ServerPy[server.py] -->|Contains| ParseLogTool[parse_charles_log tool]
        ServerPy -->|Contains| ParseSaveLogTool[parse_and_save_charles_log tool]
        ServerPy -->|Contains| LargeFileTool[read_large_file_part tool] 
        ServerPy -->|Contains| DashboardTool[view_charles_log_dashboard tool]
    end
    
    %% Input Files
    CHLSJFile[(.chlsj file)] -->|Input| ParseLogTool
    CHLSJFile -->|Input| ParseSaveLogTool
    CHLSJFile -->|Input chunk by chunk| LargeFileTool
    
    %% Processing Flow
    ParseLogTool -->|Processes| LogData[Log Data]
    ParseSaveLogTool -->|Processes & Saves| SavedJSON[Saved JSON]
    LargeFileTool -->|Processes chunks| LogData
    
    %% Dashboard Components
    subgraph "Dashboard Components"
        DashboardTool -->|Generates| HTMLDashboard[HTML Dashboard]
        SavedJSON -->|Input for| StreamlitDashboard[Streamlit Dashboard]
        
        %% Dashboard Files
        subgraph "HTML Dashboard"
            HTMLTemplate[templates/dashboard.html]
            CSSStyles[static/css/dashboard.css]
            JSCharts[static/js/dashboard.js]
        end
        
        DashboardTool -->|Uses| HTMLTemplate
        DashboardTool -->|Uses| CSSStyles
        DashboardTool -->|Uses| JSCharts
    end
    
    %% Output Files
    HTMLDashboard -->|Shows| VisualizedData[Visualized Data]
    StreamlitDashboard -->|Shows| VisualizedData
    
    %% Optional Flow
    User -->|Run for large files| LargeExample[large_file_example.py]
    LargeExample -->|Processes| CHLSJFile
    LargeExample -->|Uses| LargeFileTool
    User -->|Run for simple visualization| SimpleDashboard[simple_dashboard.py]
    SavedJSON -->|Input for| SimpleDashboard
    
    %% Start Scripts
    RunScriptSh[run_dashboard.sh] -->|Starts| StreamlitDashboard
    RunScriptBat[run_dashboard.bat] -->|Starts| StreamlitDashboard
    
    %% Legend and Styling
    classDef core fill:#f9f,stroke:#333,stroke-width:2px;
    classDef dashboard fill:#bbf,stroke:#333,stroke-width:1px;
    classDef file fill:#bfb,stroke:#333,stroke-width:1px;
    classDef script fill:#ffb,stroke:#333,stroke-width:1px;
    
    class ServerPy,ParseLogTool,ParseSaveLogTool,LargeFileTool core;
    class HTMLDashboard,StreamlitDashboard,SimpleDashboard,HTMLTemplate,CSSStyles,JSCharts dashboard;
    class CHLSJFile,SavedJSON,LogData file;
    class RunScriptSh,RunScriptBat,LargeExample,ClientPy script;
```

# Simplified Flow Diagram

For a simpler understanding of the project workflow:

```mermaid
graph TD
    A[Charles Proxy] -->|Export logs as .chlsj| B[Log File]
    B --> C{Parse Log}
    C -->|Basic parsing| D[All Entries]
    C -->|Filter by host| E[Host-specific Entries]
    
    D --> F[Generate Output]
    E --> F
    
    F -->|Raw format| G[Raw JSON]
    F -->|Summary format| H[Summary Statistics]
    F -->|Detailed format| I[Detailed Entries]
    
    G --> J[Save to File/View Dashboard]
    H --> J
    I --> J
    
    style A fill:#f9d5e5,stroke:#333,stroke-width:2px
    style B fill:#eeeeee,stroke:#333,stroke-width:2px
    style C fill:#e3f2fd,stroke:#333,stroke-width:2px
    style D fill:#e8f5e9,stroke:#333,stroke-width:2px
    style E fill:#e8f5e9,stroke:#333,stroke-width:2px
    style F fill:#fff9c4,stroke:#333,stroke-width:2px
    style G fill:#f5f5f5,stroke:#333,stroke-width:2px
    style H fill:#f5f5f5,stroke:#333,stroke-width:2px
    style I fill:#f5f5f5,stroke:#333,stroke-width:2px
    style J fill:#d1c4e9,stroke:#333,stroke-width:2px
```

## Project Components Explanation

### Core Components
- **server.py**: MCP server implementing the parser tools
- **client.py**: Client interface for users to parse Charles log files
- **parse_charles_log**: Tool to parse a log file and return data
- **parse_and_save_charles_log**: Tool to parse a log file and save results
- **read_large_file_part**: Tool to process large files in chunks
- **view_charles_log_dashboard**: Tool to visualize parsed data in HTML dashboard

### Dashboard Components
- **HTML Dashboard**: Generated by view_charles_log_dashboard tool
  - **dashboard.html**: HTML template for the dashboard
  - **dashboard.css**: Styling for the dashboard
  - **dashboard.js**: Interactive charts using Chart.js
- **Streamlit Dashboard**: Interactive Python-based dashboard
  - **dashboard.py**: Streamlit app for data visualization
  - **run_dashboard.sh/.bat**: Scripts to launch the Streamlit dashboard

### Data Flow
1. User provides a Charles log file (.chlsj)
2. File is parsed using MCP tools (parse_charles_log or parse_and_save_charles_log)
3. Results are either:
   - Returned directly as JSON data
   - Saved to a JSON file in the output directory
4. Visualization options:
   - HTML Dashboard: Opens directly in browser with interactive charts
   - Streamlit Dashboard: User runs script for advanced data exploration
   - Simple Dashboard: Alternative lightweight HTML visualization

### Alternative Flows
- **Large File Processing**: For very large log files, using large_file_example.py 
  for chunk-by-chunk processing
- **Simple Dashboard**: For environments with limited dependencies 